{"version":3,"sources":["../../server/models/UserStocks.js"],"names":["stockSchema","mongoose","Schema","symbol","String","data","Types","Mixed","percentChange","Number","timeline","id","stockDataSchema","_id","type","default","userId","stocks","timestamps","collection","statics","createUserStocks","create","error","updateUserStocks","foundStocks","findOne","update","updated","console","log","getStocksById","getStocksByUserId","getAllStocks","find","deleteStocksById","deleteOne","deleteStocksByUserId","getStocks","ids","$in","users","model"],"mappings":"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","sourcesContent":["// imports\nimport mongoose from \"mongoose\";\nimport { nanoid } from \"nanoid\";\n\n// Schema for the stock Objects\nconst stockSchema = new mongoose.Schema(\n  {\n    symbol: String,\n    data: [mongoose.Schema.Types.Mixed],\n    percentChange: Number,\n    timeline: String,\n    id: String,\n  },\n);\n\n// Schema for the user stocks model\nconst stockDataSchema = new mongoose.Schema(\n  {\n    _id: {\n      type: String,\n      default: () => nanoid(),\n    },\n    userId: String,\n    stocks: [stockSchema],\n  },\n  {\n    timestamps: true,\n    collection: \"stocks\",\n  }\n);\n\n// Creates user stock data\nstockDataSchema.statics.createUserStocks = async function (userId, stocks) {\n  try {\n    // create the stocks if they do not exist\n    return await this.create({ userId, stocks });\n  } catch (error) {\n    throw error;\n  }\n}\n\n// Updates user stock data\nstockDataSchema.statics.updateUserStocks = async function (userId, stocks) {\n  try {\n    // find the stocks for the specified user\n    const foundStocks = await this.findOne({ userId: userId });\n    if (!foundStocks) throw ({ error: 'No stocks with this userId found' });\n    // update the stocks\n    this.update({ _id: foundStocks._id }, { stocks: stocks });\n    const updated = await this.findOne({ userId: userId });\n    console.log(updated);\n    //this.markModified();\n  } catch (error) {\n    throw error;\n  }\n}\n\n// Get the stocks by their id and return the found stocks if they exist\nstockDataSchema.statics.getStocksById = async function (id) {\n  try {\n    const stocks = await this.findOne({ _id: id });\n    if (!stocks) throw ({ error: 'No stocks with this id found' });\n    return stocks;\n  } catch (error) {\n    throw error;\n  }\n}\n\n// Get the stocks by their userId and return the found stocks if they exist\nstockDataSchema.statics.getStocksByUserId = async function (userId) {\n  try {\n    return await this.findOne({ userId: userId });\n  } catch (error) {\n    throw error;\n  }\n}\n\n// Get all user stocks in the database and return them\nstockDataSchema.statics.getAllStocks = async function () {\n  try {\n    return await this.find();\n  } catch (error) {\n    throw error;\n  }\n}\n\n// Delete stocks with the given id and return the result\nstockDataSchema.statics.deleteStocksById = async function (id) {\n  try {\n    return await this.deleteOne({ _id: id });\n  } catch (error) {\n    throw error;\n  }\n}\n\n// Delete the stocks by their userId and return result\nstockDataSchema.statics.deleteStocksByUserId = async function (userId) {\n  try {\n    return await this.deleteOne({ userId: userId });\n  } catch (error) {\n    throw error;\n  }\n}\n\n// Get stocks by their ids and return the found stocks\nstockDataSchema.statics.getStocks = async function (ids) {\n  try {\n    const stocks = await this.find({ _id: { $in: ids } });\n    if (!stocks) throw ({ error: 'No stocks with these ids were found' });\n    return users;\n  } catch (error) {\n    throw error;\n  }\n}\n\nexport default mongoose.model(\"UserStocks\", stockDataSchema);\n"],"file":"UserStocks.js"}