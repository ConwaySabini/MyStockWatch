{"version":3,"sources":["../../server/controllers/UserController.js"],"names":["validator","require","onGetUserById","req","res","user","User","getUserById","params","id","status","json","success","error","onGetUserByEmail","getUserByEmail","email","onGetAllUsers","console","log","users","getUsers","onCreateUser","validation","firstName","lastName","type","password","body","isEmail","String","found","createUser","onDeleteUserById","deleteUserById","message","deletedCount","onVerifyUser","verifyPassword","_id"],"mappings":"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","sourcesContent":["// libraries\nconst validator = require('validator');\n// models\nimport User from '../models/User.js';\n\n// Export User Controller\nexport default {\n  // Finds a user by their id and returns the user on success\n  onGetUserById: async (req, res) => {\n    try {\n      const user = await User.getUserById(req.params.id);\n      return res.status(200).json({ success: true, user });\n    } catch (error) {\n      return res.status(500).json({ success: false, error: error });\n    }\n  },\n\n  // Finds a user with their email and returns the user if they exist, \n  // otherwise returns an error\n  onGetUserByEmail: async (req, res) => {\n    try {\n      // get the user and return the user if available\n      const user = await User.getUserByEmail(req.params.email);\n      return res.status(200).json({ success: true, user });\n    } catch (error) {\n      return res.status(500).json({ success: false, error: error });\n    }\n  },\n\n  // Returns a list of all users\n  onGetAllUsers: async (req, res) => {\n    try {\n      console.log(User);\n      // finds all users and returns them if there are any users\n      const users = await User.getUsers();\n      return res.status(200).json({ success: true, users });\n    } catch (error) {\n      console.log(error);\n      return res.status(500).json({ success: false, error: error });\n    }\n  },\n\n  // Tries to create a user, returns the user on success, \n  // otherwise returns an error\n  onCreateUser: async (req, res) => {\n    try {\n      let validation = true;\n      const { firstName, lastName, type, email, password, } = req.body;\n      // Validate the data from the request\n      if (!(validator.isEmail(email))) {\n        validation = false;\n      }\n      if (!(typeof password === 'string' || password instanceof String)) {\n        validation = false;\n      }\n      if (!(typeof firstName === 'string' || firstName instanceof String)) {\n        validation = false;\n      }\n      if (!(typeof lastName === 'string' || lastName instanceof String)) {\n        validation = false;\n      }\n      // throw error on validation failure\n      if (!validation) return res.status(400).json(validation);\n      // Find if the user already exists\n      const found = await User.getUserByEmail(email);\n      // throw error if user already exists\n      if ((found !== null)) return res.status(500).json({\n        success: false,\n        error: 'There is already an account associated with this email.'\n      });\n      // create the user\n      const user = await User.createUser(\n        firstName,\n        lastName,\n        type,\n        email,\n        password\n      );\n      // return the user and success message\n      return res.status(200).json({ success: true, user });\n    } catch (error) {\n      return res.status(500).json({ success: false, error: error });\n    }\n  },\n\n  // Delete the user with the given id and returns the success message on success,\n  // otherwise returns an error\n  onDeleteUserById: async (req, res) => {\n    try {\n      const user = await User.deleteUserById(req.params.id);\n      return res.status(200).json({\n        success: true,\n        message: `Deleted a count of ${user.deletedCount} user.`\n      });\n    } catch (error) {\n      return res.status(500).json({ success: false, error: error });\n    }\n  },\n\n  // Verify the user with the email and password\n  onVerifyUser: async (req, res) => {\n    try {\n      let validation = true;\n      const { email, password } = req.body;\n      // Validate the data from the request\n      if (!(validator.isEmail(email))) {\n        validation = false;\n      }\n      if (!(typeof password === 'string' || password instanceof String)) {\n        validation = false;\n      }\n      // throw error on validation failure\n      if (!validation) return res.status(400).json(validation);\n      // Verify the user email and password\n      const user = await User.verifyPassword(email, password);\n      if (user) return res.status(200).json({ success: true, id: user._id });\n      else return res.status(500).json({ success: false, error: 'Password is incorrect.' })\n    } catch (error) {\n      return res.status(500).json({ success: false, error: error });\n    }\n  },\n}\n"],"file":"UserController.js"}