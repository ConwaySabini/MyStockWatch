{"version":3,"sources":["../../server/controllers/StocksController.js"],"names":["validator","require","onGetStocksById","req","res","stocks","UserStocks","getStocksById","params","id","status","json","success","error","onGetStocksByUserId","getStocksByUserId","userId","onGetAllStocks","getAllStocks","onCreateStocks","validation","body","String","foundStocks","createdStocks","createUserStocks","onUpdateStocksByUserId","updateUserStocks","message","onDeleteStocksById","deletedStocks","deleteStocksById","deletedCount","onDeleteStocksByUserId","deleteStocksByUserId"],"mappings":"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","sourcesContent":["// libraries\nconst validator = require('validator');\n// models\nimport UserStocks from '../models/UserStocks';\n\n// Export User Controller\nexport default {\n  // Finds stocks by their id and returns the stocks on success\n  onGetStocksById: async (req, res) => {\n    try {\n      const stocks = await UserStocks.getStocksById(req.params.id);\n      return res.status(200).json({ success: true, stocks });\n    } catch (error) {\n      return res.status(500).json({ success: false, error: error });\n    }\n  },\n\n  // Find stocks with their userId and returns the stocks if they exist,\n  // otherwise returns an error\n  onGetStocksByUserId: async (req, res) => {\n    try {\n      // get the stocks and return the stocks if available\n      const stocks = await UserStocks.getStocksByUserId(req.params.userId);\n      return res.status(200).json({ success: true, stocks });\n    } catch (error) {\n      return res.status(500).json({ success: false, error: error });\n    }\n  },\n\n  // Returns a list of all stocks\n  onGetAllStocks: async (req, res) => {\n    try {\n      // finds all stocks and returns them if there are any stocks\n      const stocks = await UserStocks.getAllStocks();\n      return res.status(200).json({ success: true, stocks });\n    } catch (error) {\n      return res.status(500).json({ success: false, error: error });\n    }\n  },\n\n  // Tries to create stocks, returns the stocks on success,\n  // otherwise returns an error\n  onCreateStocks: async (req, res) => {\n    try {\n      let validation = true;\n      const { userId, stocks } = req.body;\n      // Validate the data from the request\n      if (!(typeof userId === 'string' || userId instanceof String)) {\n        validation = false;\n      }\n      // throw error on validation failure\n      if (!validation) return res.status(400).json(validation);\n      // Find if the stocks already exists\n      const foundStocks = await UserStocks.getStocksByUserId(userId);\n      // throw error if stocks already exists\n      if ((foundStocks !== null)) return res.status(500).json({\n        success: false,\n        error: 'There is already stocks for this user.'\n      });\n      // create the stocks\n      const createdStocks = await UserStocks.createUserStocks(\n        userId,\n        stocks\n      );\n      // return the stocks and success message\n      return res.status(200).json({ success: true, createdStocks });\n    } catch (error) {\n      return res.status(500).json({ success: false, error: error });\n    }\n  },\n\n  // Update the stocks with the given userId and returns the success message on success,\n  // otherwise returns an error\n  onUpdateStocksByUserId: async (req, res) => {\n    try {\n      await UserStocks.updateUserStocks(req.body.userId, req.body.stocks);\n      return res.status(200).json({\n        success: true,\n        message: `Updated stocks from user ${req.body.userId}.`,\n        stocks: req.body.stocks\n      });\n    } catch (error) {\n      return res.status(500).json({ success: false, error: error });\n    }\n  },\n\n  // Delete the stocks with the given id and returns the success message on success,\n  // otherwise returns an error\n  onDeleteStocksById: async (req, res) => {\n    try {\n      const deletedStocks = await UserStocks.deleteStocksById(req.params.id);\n      return res.status(200).json({\n        success: true,\n        message: `Deleted ${deletedStocks.deletedCount} stocks.`\n      });\n    } catch (error) {\n      return res.status(500).json({ success: false, error: error });\n    }\n  },\n\n  // Delete the stocks with the given userId and returns the success message on success,\n  // otherwise returns an error\n  onDeleteStocksByUserId: async (req, res) => {\n    try {\n      const deletedStocks = await UserStocks.deleteStocksByUserId(req.params.userId);\n      return res.status(200).json({\n        success: true,\n        message: `Deleted ${deletedStocks.deletedCount} stocks.`\n      });\n    } catch (error) {\n      return res.status(500).json({ success: false, error: error });\n    }\n  },\n}\n"],"file":"StocksController.js"}